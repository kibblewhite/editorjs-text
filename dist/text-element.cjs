(function(){"use strict";try{if(typeof document<"u"){var e=document.createElement("style");e.appendChild(document.createTextNode(".ce-text{line-height:1.6em;outline:none}.ce-text[data-placeholder]:empty:before{content:attr(data-placeholder);color:#707684;font-weight:400;opacity:0}.codex-editor--empty .ce-block:first-child .ce-text[data-placeholder]:empty:before{opacity:1}.codex-editor--toolbox-opened .ce-block:first-child .ce-text[data-placeholder]:empty:before,.codex-editor--empty .ce-block:first-child .ce-text[data-placeholder]:empty:focus:before{opacity:0}.ce-text p:first-of-type{margin-top:0}.ce-text p:last-of-type{margin-bottom:0}[contenteditable=true].ce-text{white-space:nowrap;overflow:hidden}[contenteditable=true].ce-text br{display:none}[contenteditable=true].ce-text *{display:inline;white-space:nowrap}.ce-text.cdx-block{margin-left:var(--block-indent, 0)}")),document.head.appendChild(e)}}catch(t){console.error("vite-plugin-css-injected-by-js",t)}})();
"use strict";class i{static get DefaultPlaceHolder(){return""}static get Version(){return"0.1.10"}static get DefaultWrapElement(){return"text"}static get SupportedWrapElementsArray(){return["text","custom","title","synopsis"]}_set_wrap_element(t){this._data.wrap=i.SupportedWrapElementsArray.find(e=>e===t)??i.DefaultWrapElement}_instantiate_data(t){this._data=this.normalizeData(t||{})}constructor({data:t,config:e,api:r,readOnly:a}){this.api=r,this.readOnly=a,this._CSS={block:this.api.styles.block,wrapper:"ce-text"},this.readOnly||(this.onKeyUp=this.onKeyUp.bind(this),this.onKeyDown=this.onKeyDown.bind(this)),this._placeholder=e.placeholder?e.placeholder:i.DefaultPlaceHolder,this._data=t??{},this._element=null,this._preserveBlank=e.preserveBlank!==void 0&&e.preserveBlank,this._allowEnterKeyDown=e.allowEnterKeyDown!==void 0&&e.allowEnterKeyDown,this._hidePopoverItem=e.hidePopoverItem!==void 0&&e.hidePopoverItem,this._hideToolbar=e.hideToolbar!==void 0&&e.hideToolbar,this._startMarginZero=e.startMarginZero!==void 0&&e.startMarginZero,this._instantiate_data(t),this._set_wrap_element(e.wrapElement)}static get toolbox(){return this._hidePopoverItem===!0?[]:{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M8 9V7.2C8 7.08954 8.08954 7 8.2 7L12 7M16 9V7.2C16 7.08954 15.9105 7 15.8 7L12 7M12 7L12 17M12 17H10M12 17H14"/></svg>',title:"Text"}}_currentWrapElement(){return i.SupportedWrapElementsArray.find(t=>t.wrap===this._data.wrap).toString()??i.DefaultWrapElement}normalizeData(t){const e=t&&typeof t.text=="string"?t.text:"",r=t&&t.wrap?t.wrap:i.DefaultWrapElement;if(this.redactor){const a=this.redactor.querySelectorAll(".ce-block");if(a.length>1)for(let n=1;n<a.length;n++)a[n].remove()}return{text:e,wrap:r}}onKeyUp(t){if(t.code!=="Backspace"&&t.code!=="Delete")return;const{textContent:e}=this._element;e===""&&(this._element.innerHTML="")}onKeyDown(t){if(this._allowEnterKeyDown===!1&&t.key==="Enter")return this.api.events.emit("block:enter",{element:this._element,event:t}),t.stopPropagation(),!0}drawView(){const t=document.createElement("div");return t.classList.add(this._CSS.wrapper,this._CSS.block),t.contentEditable=!1,t.dataset.placeholder=this.api.i18n.t(this._placeholder),this._data.text&&(t.innerHTML=this._data.text),this.readOnly||(t.contentEditable=!0,t.addEventListener("keyup",this.onKeyUp),t.addEventListener("keydown",this.onKeyDown)),t}_hide_element_on_mutation(t){if(this.holder&&this.holder instanceof Node){var e=new MutationObserver(()=>{let r=this.holder?.querySelector(t);r!=null&&window.getComputedStyle(r).display!=="none"&&(r.style.display="none",e.disconnect())});e.observe(this.holder,{childList:!0,subtree:!0,attributes:!0})}else console.debug("Cannot observe mutations: holder is not a valid DOM Node")}render(){return this._element=this.drawView(),setTimeout(()=>{if(this.holder=this._element.closest(".codex-editor"),this.redactor=this.holder?.querySelector(".codex-editor__redactor"),this._hidePopoverItem===!0){this._hide_element_on_mutation('.ce-popover-item[data-item-name="text"]');const t=this.redactor.querySelectorAll(".ce-text.cdx-block");for(let e=1;e<t.length;e++){let r=t[e].closest(".ce-block");r&&r.remove()}}if(this._hideToolbar===!0&&this._hide_element_on_mutation(".ce-toolbar"),this._startMarginZero===!0){const t=this.redactor.querySelectorAll(".ce-block__content");for(let e=0;e<t.length;e++)t[e].style.setProperty("max-width","100%","important")}},1),this._element}merge(t){let e={text:this._data.text+t.text,wrap:this._data.wrap};this._data=this.normalizeData(e)}validate(t){return!(t.text.trim()===""&&!this._preserveBlank)}save(t){return{text:t.innerHTML,wrap:this._data.wrap}}onPaste(t){const e={text:t.detail.data.innerHTML};this._data=this.normalizeData(e)}static get sanitize(){return{text:{br:!1}}}static get isReadOnlySupported(){return!0}get data(){if(this._element!==null&&this._element!==void 0){const t=this._element.innerHTML;this._data.text=t}return this._data.wrap=this._currentWrapElement(),this.normalizeData(this._data)}set data(t){this._data=this.normalizeData(t),this._element!==null&&this.hydrate()}hydrate(){window.requestAnimationFrame(()=>{this._element.innerHTML=this._data.text||""})}static get pasteConfig(){return{tags:["p"]}}static get enableLineBreaks(){return!1}}module.exports=i;
